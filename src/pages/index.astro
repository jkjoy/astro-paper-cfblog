---
import BaseLayout from '../layouts/BaseLayout.astro';
import PostCard from '../components/PostCard.astro';
import Pagination from '../components/Pagination.astro';
import { getPosts, PAGE_SIZE, getUserById } from '../lib/wp';

const current = 1;
const { posts, totalPages } = await getPosts(current, PAGE_SIZE);
const user = await getUserById(1); // 获取用户 ID 为 1 的用户信息
---

<BaseLayout>
  {user && (
    <div class="-mt-2 mb-12 flex items-center">
      {user.avatar && (
        <div class="h-24 w-24 shrink-0 rounded-full border-[0.5px] border-black/10 bg-white/50 p-3 ltr:mr-5 ltr:-ml-1 rtl:-mr-1 rtl:ml-5 dark:bg-white/90!">
          <img
            class="not-prose my-0 h-full w-full rounded-full bg-black/5! hover:animate-spin dark:bg-black/80!"
            src={user.avatar}
            alt={user.name}
          />
        </div>
      )}
      <div>
        <div class="mt-3 mb-1 text-2xl font-medium text-black dark:text-white">
          {user.name}
        </div>
        {user.description && <div class="break-words">{user.description}</div>}
      </div>
    </div>
  )}

  {posts.map((post) => (
    <PostCard post={post} />
  ))}

  <Pagination current={current} totalPages={totalPages} base="/page" />
</BaseLayout>

